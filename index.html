<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FRC 6998 – QR Scanner</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;700&display=swap" rel="stylesheet">

<!-- QR Scanner Library -->
<script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>

<style>
:root {
  --stone-light: #EFE6C8;
  --stone-dark: #D8C59A;
  --earth: #3E2F1C;
  --clay: #B87333;
  --highlight: #F5EEDB;
}

body {
  font-family: 'Lexend', sans-serif;
  background: linear-gradient(to bottom, #EFE6C8, #D8C59A);
  margin:0;
  padding:0;
}

header {
  background: linear-gradient(135deg, #2B1F12, #5A3E25);
  color: var(--highlight);
  text-align: center;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
}

header h1 { font-family: 'Times New Roman', serif; text-transform:uppercase; letter-spacing:2px; }
header p { margin-top:6px; }

.container { max-width: 600px; margin:20px auto; padding:16px; }

#reader {
  width: 100%;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  margin-bottom:20px;
}

.card {
  background: linear-gradient(145deg,var(--stone-light),var(--stone-dark));
  border-radius:12px;
  padding:16px;
  box-shadow:0 4px 15px rgba(0,0,0,0.2);
  margin-bottom:16px;
}

.card h2 { border-left: 6px solid var(--clay); padding-left:10px; margin-bottom:10px; color: var(--earth); text-transform: uppercase; }

pre { white-space: pre-wrap; word-break: break-word; }
</style>
</head>

<body>
<header>
  <h1>FRC 6998 – QR Scanner</h1>
  <p>Scan QR code from pit scouting</p>
</header>

<div class="container">
  <div id="reader"></div>

  <div class="card">
    <h2>Scanned Data</h2>
    <pre id="output">Waiting for QR code...</pre>
  </div>
</div>

<script>
const output = document.getElementById("output");

function onScanSuccess(decodedText, decodedResult) {
    // Parse JSON if possible
    try {
        const data = JSON.parse(decodedText);
        let formatted = `Scouter: ${data.scouter}\nTeam: ${data.team}\n\nMechanical Systems:\n`;
        formatted += `- Intake: ${data.mech.i}\n- Output: ${data.mech.o}\n- Auto Preload: ${data.mech.ap}\n- Capacity: ${data.mech.c}\n- Ladder: ${data.mech.l}\n- Drive: ${data.mech.d}\n- Traversal: ${data.mech.t}\n\nAutonomous:\n`;
        formatted += `- Start Position: ${data.auto.s}\n- Auto Strategy: ${data.auto.st}\n- Auto Score Ability: ${data.auto.sc}\n- Estimated Score: ${data.auto.e}\n\nNotes:\n${data.n}`;
        output.textContent = formatted;
    } catch(e){
        output.textContent = "Scanned QR code is not valid JSON:\n" + decodedText;
    }
}

// Scanner config
let html5QrcodeScanner = new Html5Qrcode("reader");

html5QrcodeScanner.start(
    { facingMode: "environment" }, // rear camera preferred
    {
        fps: 10,
        qrbox: 250
    },
    onScanSuccess
).catch(err=>{
    output.textContent = "Camera permission denied or not available.\n" + err;
});
</script>
</body>
</html>
